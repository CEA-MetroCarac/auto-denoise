
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Unsupervised and self-supervised CNN denoising methods.">
      
      
      
        <link rel="canonical" href="https://CEA-MetroCarac.github.io/auto-denoise/tutorials/denoising_imgs/">
      
      
        <link rel="prev" href="../../license/">
      
      
        <link rel="next" href="../noise2inverse/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Denoising images & volumes - Auto-Denoise</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/material.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#denoising-images" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Auto-Denoise" class="md-header__button md-logo" aria-label="Auto-Denoise" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Auto-Denoise
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Denoising images & volumes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CEA-MetroCarac/auto-denoise" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CEA-MetroCarac/auto-denoise
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  Examples & Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/autoden/" class="md-tabs__link">
          
  
  
    
  
  API reference

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contributing/" class="md-tabs__link">
          
  
  
    
  
  Development

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Auto-Denoise" class="md-nav__button md-logo" aria-label="Auto-Denoise" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Auto-Denoise
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CEA-MetroCarac/auto-denoise" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    CEA-MetroCarac/auto-denoise
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Examples & Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Examples & Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Denoising images & volumes
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Denoising images & volumes
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up the Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-the-denoisers" class="md-nav__link">
    <span class="md-ellipsis">
      Training the Denoisers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training the Denoisers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1d-and-3d-signals" class="md-nav__link">
    <span class="md-ellipsis">
      1D and 3D signals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supervised-denoiser" class="md-nav__link">
    <span class="md-ellipsis">
      Supervised Denoiser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2void-n2v" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Void (N2V)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2noise-n2n" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Noise (N2N)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Noise2Noise (N2N)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batched-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Batched processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Data augmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deep-image-prior-dip" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Image Prior (DIP)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performing-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Performing Inference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performing Inference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supervised-denoiser-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Supervised Denoiser Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2void-n2v-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Void (N2V) Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2noise-n2n-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Noise (N2N) Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deep-image-prior-dip-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Image Prior (DIP) Inference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizing-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing the Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noise2inverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Noise2Inverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../denoising_spectra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Noise2Noise for spectra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models_io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Saving & loading models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Auto-Denoise
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Auto-Denoise
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/autoden/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> autoden
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> autoden
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/autoden/algorithms/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/algorithms/deep_image_prior/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> deep_image_prior
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/algorithms/denoiser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> denoiser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/algorithms/noise2noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> noise2noise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/algorithms/noise2void/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> noise2void
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/algorithms/supervised/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> supervised
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/debug/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> debug
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/losses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> losses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/autoden/models/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> models
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_6" id="__nav_3_1_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/dncnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> dncnn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/msd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> msd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/param_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> param_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/resnet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> resnet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/autoden/models/unet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> unet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code_of_conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Setting Up the Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-the-denoisers" class="md-nav__link">
    <span class="md-ellipsis">
      Training the Denoisers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training the Denoisers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1d-and-3d-signals" class="md-nav__link">
    <span class="md-ellipsis">
      1D and 3D signals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supervised-denoiser" class="md-nav__link">
    <span class="md-ellipsis">
      Supervised Denoiser
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2void-n2v" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Void (N2V)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2noise-n2n" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Noise (N2N)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Noise2Noise (N2N)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batched-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Batched processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      Data augmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deep-image-prior-dip" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Image Prior (DIP)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performing-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Performing Inference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performing Inference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supervised-denoiser-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Supervised Denoiser Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2void-n2v-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Void (N2V) Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#noise2noise-n2n-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Noise2Noise (N2N) Inference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deep-image-prior-dip-inference" class="md-nav__link">
    <span class="md-ellipsis">
      Deep Image Prior (DIP) Inference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualizing-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing the Results
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/CEA-MetroCarac/auto-denoise/edit/main/docs/tutorials/denoising_imgs.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/CEA-MetroCarac/auto-denoise/raw/main/docs/tutorials/denoising_imgs.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="denoising-images">Denoising Images<a class="headerlink" href="#denoising-images" title="Permanent link">&para;</a></h1>
<p>Auto-Denoise (autoden) provides implementations for a variety of unsupervised and self-supervised Convolutional Neural Network (CNN) denoising methods. This tutorial will guide you through setting up the data, training different denoisers, performing inference, and visualizing the results.</p>
<h2 id="setting-up-the-data">Setting Up the Data<a class="headerlink" href="#setting-up-the-data" title="Permanent link">&para;</a></h2>
<p>First, we need to set up the data to be used for training and testing the denoisers. We will use the <code>skimage</code> library to generate a noisy image and create multiple noisy versions of it.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skimage.color</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">skc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skimage.data</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">skd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skimage.transform</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">skt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NDArray</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">autoden</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ad</span>

<span class="n">USE_CAMERA_MAN</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">NUM_IMGS_TRN</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">NUM_IMGS_TST</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">NUM_IMGS_TOT</span> <span class="o">=</span> <span class="n">NUM_IMGS_TRN</span> <span class="o">+</span> <span class="n">NUM_IMGS_TST</span>

<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">REG_TV_VAL</span> <span class="o">=</span> <span class="mf">1e-7</span>

<span class="k">if</span> <span class="n">USE_CAMERA_MAN</span><span class="p">:</span>
    <span class="n">img_orig</span> <span class="o">=</span> <span class="n">skd</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
    <span class="n">img_orig</span> <span class="o">=</span> <span class="n">skt</span><span class="o">.</span><span class="n">downscale_local_mean</span><span class="p">(</span><span class="n">img_orig</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">img_orig</span> <span class="o">=</span> <span class="n">skd</span><span class="o">.</span><span class="n">cat</span><span class="p">()</span>
    <span class="n">img_orig</span> <span class="o">=</span> <span class="n">skc</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">img_orig</span><span class="p">)</span>
    <span class="n">img_orig</span> <span class="o">*=</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">img_orig</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">imgs_noisy</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
    <span class="p">[(</span><span class="n">img_orig</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">img_orig</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">NUM_IMGS_TOT</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Create noisy images&quot;</span><span class="p">)],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tst_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NUM_IMGS_TRN</span><span class="p">,</span> <span class="n">NUM_IMGS_TOT</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Img orig -&gt; [</span><span class="si">{</span><span class="n">img_orig</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">img_orig</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">], Img noisy -&gt; [</span><span class="si">{</span><span class="n">imgs_noisy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">imgs_noisy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Img shape: </span><span class="si">{</span><span class="n">img_orig</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Training vs testing images</p>
<p>Certain algorithms require to allocate a certain number of input images to the test set.
This set is used to verify the model's training convergence, and to select the most appropriate epoch.
The variable <code>tst_inds</code> serves this purpose, by containing the indexes of the images to use for testing.</p>
<p>The algorithms that do not use this variable, will randomly select a certain fixed number of pixels as leave-out set.</p>
</div>
<h2 id="training-the-denoisers">Training the Denoisers<a class="headerlink" href="#training-the-denoisers" title="Permanent link">&para;</a></h2>
<p>We will train four different denoisers: Supervised Denoiser, Noise2Noise (N2N), Noise2Void (N2V), and Deep Image Prior (DIP).
We first define the type of model that we will want to use. In this case it will be a U-net [<a href="#ref.1">1</a>], with 16 features:
<div class="highlight"><pre><span></span><code><span class="n">net_params</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">NetworkParamsUNet</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div></p>
<p>The variable <code>net_params</code> only defines the type of architecture that we want. When passed to the denoising algorithms, they will use it to create and initialize a U-net model.
Other pre-configured models are available: MS-D net [<a href="#ref.2">2</a>], DnCNN [<a href="#ref.3">3</a>], and a custom ResNet implementation [<a href="#ref.4">4</a>].</p>
<h3 id="1d-and-3d-signals">1D and 3D signals<a class="headerlink" href="#1d-and-3d-signals" title="Permanent link">&para;</a></h3>
<p>We have recently introduced the support for 1D and 3D signals in <code>auto-denoise</code>.
To correctly process these signals, it is enough to instantiate a model with the correct dimensionality.
This means that we need to set the correct value for the parameter <code>n_dims</code> in the model definition:
<div class="highlight"><pre><span></span><code><span class="n">net_params</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">NetworkParamsUNet</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_dims</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 1D Convolutions</span>
</code></pre></div>
or
<div class="highlight"><pre><span></span><code><span class="n">net_params</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">NetworkParamsUNet</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_dims</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 3D Convolutions</span>
</code></pre></div></p>
<div class="admonition node">
<p class="admonition-title">Using a 2D model with 3D data</p>
<p>It is possible to use a 3D dataset with a 2D model. The depth direction will be interpreted as the batch dimension.
The 2D model will interpret each volume slice as a different image example.</p>
<p>This could be useful in GPU memory constrained scenarios, where the higher memory requirements of 3D convolutions (w.r.t. 2D convolutions) could exceed the available GPU memory.
This technique could save around 30\% memory, but it would lose the information along the depth direction.</p>
</div>
<h3 id="supervised-denoiser">Supervised Denoiser<a class="headerlink" href="#supervised-denoiser" title="Permanent link">&para;</a></h3>
<p>The supervised denoiser is trained using pairs of noisy and clean images. It learns to map noisy images to their clean counterparts.</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_sup</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">Supervised</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">)</span>
<span class="n">sup_data</span> <span class="o">=</span> <span class="n">denoiser_sup</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">imgs_noisy</span><span class="p">,</span> <span class="n">img_orig</span><span class="p">,</span> <span class="n">num_tst_ratio</span><span class="o">=</span><span class="n">NUM_IMGS_TST</span> <span class="o">/</span> <span class="n">NUM_IMGS_TOT</span><span class="p">)</span>
<span class="n">denoiser_sup</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">*</span><span class="n">sup_data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">)</span>
</code></pre></div>
<h3 id="noise2void-n2v">Noise2Void (N2V)<a class="headerlink" href="#noise2void-n2v" title="Permanent link">&para;</a></h3>
<p>Noise2Void is a self-supervised denoising method that can work with a single noisy image [<a href="#ref.5">5</a>]. This implementation can also work with structured noise [<a href="#ref.6">6</a>]. It applies randomly generated masks to the images and learns to predict the masked pixels.</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_n2v</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">N2V</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">)</span>
<span class="n">denoiser_n2v</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">imgs_noisy</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">,</span> <span class="n">tst_inds</span><span class="o">=</span><span class="n">tst_inds</span><span class="p">)</span>
</code></pre></div>
<h3 id="noise2noise-n2n">Noise2Noise (N2N)<a class="headerlink" href="#noise2noise-n2n" title="Permanent link">&para;</a></h3>
<p>Noise2Noise is a self-supervised denoising method that uses pairs of noisy images of the same object [<a href="#ref.7">7</a>]. It learns to map one noisy image to another noisy image of the same object. The <code>prepare_data</code> function is used to organize the data in such a way that the algorithm can handle it correctly.</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_n2n</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">N2N</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">)</span>
<span class="n">n2n_data</span> <span class="o">=</span> <span class="n">denoiser_n2n</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">imgs_noisy</span><span class="p">)</span>
<span class="n">denoiser_n2n</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">*</span><span class="n">n2n_data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">)</span>
</code></pre></div>
<h4 id="batched-processing">Batched processing<a class="headerlink" href="#batched-processing" title="Permanent link">&para;</a></h4>
<p>N2N and Supervised support batched processing (both during training and inference). This is usually required for large datasets, where they cannot fully fit into GPU memory.
The batch size is selected through the <code>batch_size</code> argument when N2N is initialized.</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_sup</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">Supervised</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div>
<p>and</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_n2n</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">N2N</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div>
<h4 id="data-augmentation">Data augmentation<a class="headerlink" href="#data-augmentation" title="Permanent link">&para;</a></h4>
<p>N2N and Supervised also support data augmentation in the form of image and volume flips. This could be used to virtually increase the data size during training.</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_sup</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">Supervised</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="s2">&quot;flip&quot;</span><span class="p">)</span>
</code></pre></div>
<p>and</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_n2n</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">N2N</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span><span class="p">,</span> <span class="n">augmentation</span><span class="o">=</span><span class="s2">&quot;flip&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="deep-image-prior-dip">Deep Image Prior (DIP)<a class="headerlink" href="#deep-image-prior-dip" title="Permanent link">&para;</a></h3>
<p>Deep Image Prior is an unsupervised denoising method that can also work with a single image [<a href="#ref.8">8</a>]. It uses the prior knowledge embedded in the network architecture to denoise the image. The <code>prepare_data</code> function is used to organize the data in such a way that the algorithm can handle it correctly.</p>
<div class="highlight"><pre><span></span><code><span class="n">denoiser_dip</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">DIP</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">net_params</span><span class="p">,</span> <span class="n">reg_val</span><span class="o">=</span><span class="n">REG_TV_VAL</span> <span class="o">*</span> <span class="mf">1e1</span><span class="p">)</span>
<span class="n">dip_data</span> <span class="o">=</span> <span class="n">denoiser_dip</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">(</span><span class="n">imgs_noisy</span><span class="p">)</span>
<span class="n">denoiser_dip</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">*</span><span class="n">dip_data</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">EPOCHS</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Regularization weight</p>
<p>The DIP is more sensitive to the regularization weight, and it can be adjusted to obtain better results.</p>
</div>
<h2 id="performing-inference">Performing Inference<a class="headerlink" href="#performing-inference" title="Permanent link">&para;</a></h2>
<p>Inference is the process of using the trained models to denoise new images. The <code>infer</code> method takes the noisy images as input and outputs the denoised images.</p>
<h3 id="supervised-denoiser-inference">Supervised Denoiser Inference<a class="headerlink" href="#supervised-denoiser-inference" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">den_sup</span> <span class="o">=</span> <span class="n">denoiser_sup</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">sup_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Inference input</p>
<p>The output of the <code>prepare_data</code> function is also preferred for the inference of Supervised, even though the noisy images should still work for the foreseeable future.</p>
</div>
<h3 id="noise2void-n2v-inference">Noise2Void (N2V) Inference<a class="headerlink" href="#noise2void-n2v-inference" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">den_n2v</span> <span class="o">=</span> <span class="n">denoiser_n2v</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">imgs_noisy</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<h3 id="noise2noise-n2n-inference">Noise2Noise (N2N) Inference<a class="headerlink" href="#noise2noise-n2n-inference" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">den_n2n</span> <span class="o">=</span> <span class="n">denoiser_n2n</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">n2n_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Inference input</p>
<p>The output of the <code>prepare_data</code> function is also needed for the inference of N2N.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Inference output</p>
<p>The <code>inference</code> function of N2N  automatically averages the splits, unless the <code>average_splits</code> flag is set to <code>False</code>.</p>
</div>
<h3 id="deep-image-prior-dip-inference">Deep Image Prior (DIP) Inference<a class="headerlink" href="#deep-image-prior-dip-inference" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">den_dip</span> <span class="o">=</span> <span class="n">denoiser_dip</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">dip_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Inference input</p>
<p>The output of the <code>prepare_data</code> function is also needed for the inference of DIP.</p>
</div>
<h2 id="visualizing-the-results">Visualizing the Results<a class="headerlink" href="#visualizing-the-results" title="Permanent link">&para;</a></h2>
<p>Finally, we visualize the results of the different denoisers.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="image" name="__tabbed_1" type="radio" /><input id="code" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="image">Image</label><label for="code">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><img alt="results image" src="../../images/denoise_imgs_results.png" /></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_orig</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Original image&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgs_noisy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Noisy image&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">den_sup</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Denoised supervised&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">den_n2n</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Denoised N2N&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">den_n2v</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Denoised N2V&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">den_dip</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Denoised DIP&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<p>And here below we present the PSNR (Peak Signal-to-Noise Ration), SSIM (Structural Similarity Index) and FRC (Fourier Ring Correlation) of the results.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="image_1" name="__tabbed_2" type="radio" /><input id="code_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="image_1">Image</label><label for="code_1">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>PSNR:</p>
<ul>
<li>Supervised: 33.7</li>
<li>Noise2Void: 26.1</li>
<li>Noise2Noise: 32.6</li>
<li>Deep Image Prior: 29.7</li>
</ul>
<p>SSIM:</p>
<ul>
<li>Supervised: 0.901</li>
<li>Noise2Void: 0.776</li>
<li>Noise2Noise: 0.884</li>
<li>Deep Image Prior: 0.825</li>
</ul>
<p><img alt="results image frcs" src="../../images/denoise_imgs_results_frcs.png" /></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">corrct.processing.post</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_frcs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skimage.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">peak_signal_noise_ratio</span> <span class="k">as</span> <span class="n">psnr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skimage.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">structural_similarity</span> <span class="k">as</span> <span class="n">ssim</span>

<span class="n">all_recs</span> <span class="o">=</span> <span class="p">[</span><span class="n">den_sup</span><span class="p">,</span> <span class="n">den_n2v</span><span class="p">,</span> <span class="n">den_n2n</span><span class="p">,</span> <span class="n">den_dip</span><span class="p">]</span>
<span class="n">all_labs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Supervised&quot;</span><span class="p">,</span> <span class="s2">&quot;Noise2Void&quot;</span><span class="p">,</span> <span class="s2">&quot;Noise2Noise&quot;</span><span class="p">,</span> <span class="s2">&quot;Deep Image Prior&quot;</span><span class="p">]</span>

<span class="n">data_range</span> <span class="o">=</span> <span class="n">img_orig</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">img_orig</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PSNR:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_recs</span><span class="p">,</span> <span class="n">all_labs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">psnr</span><span class="p">(</span><span class="n">img_orig</span><span class="p">,</span><span class="w"> </span><span class="n">rec</span><span class="p">,</span><span class="w"> </span><span class="n">data_range</span><span class="o">=</span><span class="n">data_range</span><span class="p">)</span><span class="si">:</span><span class="s2">.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SSIM:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rec</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_recs</span><span class="p">,</span> <span class="n">all_labs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">lab</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">ssim</span><span class="p">(</span><span class="n">img_orig</span><span class="p">,</span><span class="w"> </span><span class="n">rec</span><span class="p">,</span><span class="w"> </span><span class="n">data_range</span><span class="o">=</span><span class="n">data_range</span><span class="p">)</span><span class="si">:</span><span class="s2">.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plot_frcs</span><span class="p">([(</span><span class="n">img_orig</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">rec</span><span class="p">)</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">all_recs</span><span class="p">],</span> <span class="n">all_labs</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ol>
<li><a id="ref.1"></a> O. Ronneberger, P. Fischer, and T. Brox, U-Net: Convolutional Networks for Biomedical Image Segmentation, in Medical Image Computing and Computer-Assisted Intervention  MICCAI 2015, 2015, pp. 234241. doi: 10.1007/978-3-319-24574-4_28.</li>
<li><a id="ref.2"></a> D. M. Pelt and J. A. Sethian, A mixed-scale dense convolutional neural network for image analysis, Proceedings of the National Academy of Sciences, vol. 115, no. 2, pp. 254259, 2018, doi: 10.1073/pnas.1715832114.</li>
<li><a id="ref.3"></a> K. Zhang, W. Zuo, Y. Chen, D. Meng, and L. Zhang, Beyond a Gaussian Denoiser: Residual Learning of Deep CNN for Image Denoising, IEEE Transactions on Image Processing, vol. 26, no. 7, pp. 31423155, Jul. 2017, doi: 10.1109/TIP.2017.2662206.</li>
<li><a id="ref.4"></a> K. He, X. Zhang, S. Ren, and J. Sun, Deep Residual Learning for Image Recognition, in 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR), IEEE, Jun. 2016, pp. 770778. doi: 10.1109/CVPR.2016.90.</li>
<li><a id="ref.5"></a> A. Krull, T.-O. Buchholz, and F. Jug, Noise2Void - Learning Denoising From Single Noisy Images, in 2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), IEEE, Jun. 2019, pp. 21242132. doi: <a href="https://doi.org/10.1109/CVPR.2019.00223">10.1109/CVPR.2019.00223</a>.</li>
<li><a id="ref.6"></a> C. Broaddus, A. Krull, M. Weigert, U. Schmidt, and G. Myers, Removing Structured Noise with Self-Supervised Blind-Spot Networks, in 2020 IEEE 17th International Symposium on Biomedical Imaging (ISBI), IEEE, Apr. 2020, pp. 159163. doi: <a href="https://doi.org/10.1109/ISBI45749.2020.9098336">10.1109/ISBI45749.2020.9098336</a>.</li>
<li><a id="ref.7"></a> J. Lehtinen et al., Noise2Noise: Learning Image Restoration without Clean Data, in Proceedings of the 35th International Conference on Machine Learning, J. Dy and A. Krause, Eds., in Proceedings of Machine Learning Research, vol. 80. PMLR, 2018, pp. 29652974. <a href="https://proceedings.mlr.press/v80/lehtinen18a.html">https://proceedings.mlr.press/v80/lehtinen18a.html</a>.</li>
<li><a id="ref.8"></a> V. Lempitsky, A. Vedaldi, and D. Ulyanov, Deep Image Prior, in 2018 IEEE/CVF Conference on Computer Vision and Pattern Recognition, IEEE, Jun. 2018, pp. 94469454. doi: <a href="https://doi.org/10.1109/CVPR.2018.00984">10.1109/CVPR.2018.00984</a>.</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../license/" class="md-footer__link md-footer__link--prev" aria-label="Previous: License">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                License
              </div>
            </div>
          </a>
        
        
          
          <a href="../noise2inverse/" class="md-footer__link md-footer__link--next" aria-label="Next: Noise2Inverse">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Noise2Inverse
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Nicola VIGANO
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Obi-Wan" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/auto-denoise/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>